version: '3.9'
services:
  xray:
    image: teddysun/xray
    command: xray run -c /etc/xray/config.json
    volumes:
      - ./config.client.json:/etc/xray/config.json
    ports:
      - 127.0.0.1:1080:1080
      - 127.0.0.1:3128:3128
  redsocks:
    image: apiv1/redsocks
    command: localhost 1080
    network_mode: host
    privileged: true
    environment:
      START_FW: 1
    depends_on:
      - xray